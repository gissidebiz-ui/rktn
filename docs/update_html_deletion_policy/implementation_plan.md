# 実装計画 - HTML削除ポリシーの更新 (当日分は最新のみ)

HTMLリダイレクト用のHTMLファイルについて、既存の5日間保持ポリシーに加え、「当日分は最新の実行分のみを保持する」という条件を追加します。

## 変更内容

### [affiliate_post_generator.py](file:///c:/Users/hax37/Documents/yusuke_doc/git/work/rktn/src/affiliate_post_generator.py) [MODIFY]

- `cleanup_html` メソッドを修正します。
- 当日の日付を持つファイルを特定し、その中で最も新しい更新時刻（mtime）を持つファイルを探します。
- 最新のファイルから一定時間内（例: 10分以内）に作成された「最新の実行セット」を除き、当日の他の古いファイルを削除するようにロジックを更新します。
- `from datetime import datetime` をインポートに追加します。

## ユーザー確認事項

> [!IMPORTANT]
> 「最新分のみ保持」の定義について：
> 1回の実行で複数の商品（例: 24個）のHTMLが生成されますが、これらすべてを「最新のセット」として保持する意図で進めます。。もし、本当に「当日の全ファイルのうち、絶対的に最後の1ファイルのみ」を残したい（＝他の23個のリンクは切れても良い）という意図であれば、その旨お知らせください。

## 検証計画

### 手動検証

1. `src/run_all.py` を2回連続で実行します。
2. `html/` フォルダを確認し、1回目の実行で生成されたファイル群が削除され、2回目の実行分のみが残っていることを確認します。
